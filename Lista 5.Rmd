---
title: "Análise descritiva - myopia database"
author: "Aline Cristina Pinto (2020031412) e Sofia Aguiar (2020031811)"
output: 
  html_document:
    theme: cosmo
    toc: false
    number_sections: false
---

```{r setup, include=FALSE}
library(flexdashboard)
if (!require(pacman)) install.packages('pacman')
library(pacman)
pacman::p_load(tidyverse, gt, aplore3, RcolorBrewer, hrbrthemes)

data('myopia')
dados = myopia
```

## {.tabset .tabset-fade}

### Gráficos

(tab content)

### Tabelas

<div align="center">**Tabela 1 - Relação entre pais, filhos e miopia**</div>

```{r, echo=FALSE}

freq_relativa = function(dados, miope, maemiope, paimiope){
  total = as.numeric(count(filter(dados, myopic == miope)))
  rotulo = as.numeric(count(filter(dados,
                                   myopic == miope 
                                   & mommy == maemiope
                                   & dadmy == paimiope)))
  return (rotulo/total*100)
}

ambos = c(freq_relativa(dados, "Yes", "Yes", "Yes"),
          freq_relativa(dados, "No", "Yes", "Yes"))

apenas_mae = c(freq_relativa(dados, "Yes", "Yes", "No"),
               freq_relativa(dados, "No", "Yes", "No"))

apenas_pai = c(freq_relativa(dados, "Yes", "No", "Yes"),
               freq_relativa(dados, "No", "No", "Yes"))

nenhum = c(freq_relativa(dados, "Yes", "No", "No"),
           freq_relativa(dados, "No", "No", "No"))

tabela = data.frame(crianca = c("Míope", "Não míope"), 
                   ambos, 
                   apenas_mae,
                   apenas_pai,
                   nenhum)
```

```{r, echo=FALSE}

tabela %>% gt() %>% 
  tab_header(title = "Relação entre pais, filhos e miopia") %>%
  cols_label(
    crianca = 'Criança',
    apenas_mae = 'Apenas mãe',
    apenas_pai = 'Apenas pai',
    ambos = 'Ambos', 
    nenhum = 'Nenhum'
  ) %>%
  tab_spanner(label = "Pais com miopia (%)", 
              columns = c(ambos, apenas_mae, apenas_pai,nenhum)) %>% 
  fmt_number(columns = c(ambos, apenas_mae, apenas_pai, nenhum), decimals = 2)
```

<br>
<div align="center">
A _Tabela 1 - Relação entre pais, filhos e miopia_ foi criada a partir das variáveis myopic, mommy e dadmy, e busca mostrar, através de uma tabela de frequência relativa, a proporção de crianças míopes e não míopes e a condição de seus pais.

Pode-se observar que para crianças que possuem miopia, apenas 6% dos pais não possuem essa condição óptica. Já para as crianças que não possuem miopia, essa proporção é quase igualmente distribuída entre as opções de ambos os pais possuírem miopia, apenas a mãe, apenas o pai ou nenhum deles possuírem essa condição óptica. 
</div>

<br>
<div align="center">**Tabela 2 - Condição de miopia das crianças por sexo **</div>
```{r, echo=FALSE}

tabela = round(prop.table(table(dados$myopic, dados$gender))*100, digits=2)
tabela= as.data.frame.matrix(tabela) 
rownames(tabela) = NULL
```

```{r, echo=FALSE}

tabela %>% gt() %>% 
  tab_header(title = "Condição de miopia das crianças por sexo") %>%
  cols_label(
    Male = 'Masculino',
    Female = 'Feminino'
  )
```

<br>
<div align="center">
A _Tabela 2 - Condição de miopia das crianças por sexo_ foi criada a partir das variáveis myopic e gender, e busca mostrar, através de uma tabela de frequência relativa, a proporção de crianças míopes e não míopes pelo sexo.

Pode-se observar que a maioria das crianças, independente do sexo, não possuem miopia. Ainda, a proporção de crianças do sexo feminino que possuem miopia é maior do que as crianças do sexo masculino, porém essa diferença é muito pequena.
</div>

### Sobre

testestets